!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("BinPacking",[],e):"object"==typeof exports?exports.BinPacking=e():t.BinPacking=e()}(this,(function(){return function(){"use strict";var t={416:function(t,e,i){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.d(e,{Z:function(){return n}})},225:function(t,e,i){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}i.d(e,{Z:function(){return o}})},743:function(t,e,i){function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{Z:function(){return n}})}},e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return function(){i.r(n),i.d(n,{Bin:function(){return a},Item:function(){return f},Packer:function(){return p}});var t=i(416),e=i(225),o=i(743),h=function(t){return Math.round(t*Math.pow(10,5))};function r(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n]}var s,u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"binpackingjs";return r.bind(void 0,t)}("3D:"),a=function(){function i(e,n,r,s,u){(0,t.Z)(this,i),(0,o.Z)(this,"name",""),(0,o.Z)(this,"width",0),(0,o.Z)(this,"height",0),(0,o.Z)(this,"depth",0),(0,o.Z)(this,"maxWeight",0),(0,o.Z)(this,"items",[]),this.name=e,this.width=h(n),this.height=h(r),this.depth=h(s),this.maxWeight=h(u)}return(0,e.Z)(i,[{key:"getName",value:function(){return this.name}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getDepth",value:function(){return this.depth}},{key:"getMaxWeight",value:function(){return this.maxWeight}},{key:"getItems",value:function(){return this.items}},{key:"getVolume",value:function(){return this.getWidth()*this.getHeight()*this.getDepth()}},{key:"getPackedWeight",value:function(){return this.items.reduce((function(t,e){return t+e.getWeight()}),0)}},{key:"weighItem",value:function(t){var e=this.getMaxWeight();return!e||t.getWeight()+this.getPackedWeight()<=e}},{key:"scoreRotation",value:function(t,e){t.rotationType=e;var i=t.getDimension();return this.getWidth()<i[0]||this.getHeight()<i[1]||this.getDepth()<i[2]?0:Math.pow(i[0]/this.getWidth(),2)+Math.pow(i[1]/this.getHeight(),2)+Math.pow(i[2]/this.getDepth(),2)}},{key:"getBestRotationOrder",value:function(t){for(var e={},i=0;i<t.allowedRotation.length;i++){var n=t.allowedRotation[i];e[n]=this.scoreRotation(t,n)}return Object.keys(e).sort((function(t,i){return e[i]-e[t]})).map(Number)}},{key:"putItem",value:function(t,e){var i=this,n=!1,o=this.getBestRotationOrder(t);t.position=e;for(var h=0;h<o.length;h++){t.rotationType=o[h];var r=t.getDimension();if(i.getWidth()<e[0]+r[0]||i.getHeight()<e[1]+r[1]||i.getDepth()<e[2]+r[2])n=!1;else{n=!0;for(var s=0;s<i.items.length;s++)if(i.items[s].intersect(t)){n=!1;break}n&&i.items.push(t)}if(u("try to putItem",n,"item",t.toString(),"box",i.toString()),n)break}return n}},{key:"toString",value:function(){return"Bin:".concat(this.name," (WxHxD = ").concat(this.getWidth(),"x").concat(this.getHeight(),"x").concat(this.getDepth(),", MaxWg. = ").concat(this.getMaxWeight(),")")}}]),i}(),g=[0,0,0],c=(s={},(0,o.Z)(s,0,"RotationType_WHD (w,h,d)"),(0,o.Z)(s,1,"RotationType_HWD (h,w,d)"),(0,o.Z)(s,2,"RotationType_HDW (h,d,w)"),(0,o.Z)(s,3,"RotationType_DHW (d,h,w)"),(0,o.Z)(s,4,"RotationType_DWH (d,w,h)"),(0,o.Z)(s,5,"RotationType_WDH (w,d,h)"),s),f=function(){function i(e,n,r,s,u,a){(0,t.Z)(this,i),(0,o.Z)(this,"name",""),(0,o.Z)(this,"width",0),(0,o.Z)(this,"height",0),(0,o.Z)(this,"depth",0),(0,o.Z)(this,"weight",0),(0,o.Z)(this,"allowedRotation",[0,1,2,3,4,5]),(0,o.Z)(this,"rotationType",0),(0,o.Z)(this,"position",[]),this.name=e,this.width=h(n),this.height=h(r),this.depth=h(s),this.weight=h(u),this.allowedRotation=a||this.allowedRotation}return(0,e.Z)(i,[{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getDepth",value:function(){return this.depth}},{key:"getWeight",value:function(){return this.weight}},{key:"getRotationType",value:function(){return this.rotationType}},{key:"getAllowedRotation",value:function(){return this.allowedRotation}},{key:"getRotationTypeString",value:function(){return c[this.getRotationType()]}},{key:"getDimension",value:function(){var t;switch(this.rotationType){case 0:t=[this.getWidth(),this.getHeight(),this.getDepth()];break;case 1:t=[this.getHeight(),this.getWidth(),this.getDepth()];break;case 2:t=[this.getHeight(),this.getDepth(),this.getWidth()];break;case 3:t=[this.getDepth(),this.getHeight(),this.getWidth()];break;case 4:t=[this.getDepth(),this.getWidth(),this.getHeight()];break;case 5:t=[this.getWidth(),this.getDepth(),this.getHeight()]}return t}},{key:"intersect",value:function(t){return l(this,t,0,1)&&l(this,t,1,2)&&l(this,t,0,2)}},{key:"getVolume",value:function(){return this.getWidth()*this.getHeight()*this.getDepth()}},{key:"toString",value:function(){return"Item:".concat(this.name," (").concat(this.getRotationTypeString()," = ").concat(this.getDimension().join("x"),", Wg. = ").concat(this.weight,")")}}]),i}(),l=function(t,e,i,n){var o,h,r,s,u,a,g,c;return o=t.getDimension(),h=e.getDimension(),r=t.position[i]+o[i]/2,s=t.position[n]+o[n]/2,u=e.position[i]+h[i]/2,a=e.position[n]+h[n]/2,g=Math.max(r,u)-Math.min(r,u),c=Math.max(s,a)-Math.min(s,a),g<(o[i]+h[i])/2&&c<(o[n]+h[n])/2},p=function(){function i(){(0,t.Z)(this,i),(0,o.Z)(this,"bins",[]),(0,o.Z)(this,"items",[]),(0,o.Z)(this,"unfitItems",[])}return(0,e.Z)(i,[{key:"addBin",value:function(t){this.bins.push(t)}},{key:"addItem",value:function(t){this.items.push(t)}},{key:"findFittedBin",value:function(t){for(var e=0;e<this.bins.length;e++){var i=this.bins[e];if(i.weighItem(t)&&i.putItem(t,g))return 1===i.items.length&&i.items[0]===t&&(i.items=[]),i}return null}},{key:"getBiggerBinThan",value:function(t){for(var e=t.getVolume(),i=0;i<this.bins;i++){var n=this.bins[i];if(n.getVolume()>e)return n}return null}},{key:"unfitItem",value:function(){0!==this.items.length&&(this.unfitItems.push(this.items[0]),this.items.splice(0,1))}},{key:"packToBin",value:function(t,e){var i=null,n=[];if(!t.weighItem(e[0])||!t.putItem(e[0],g)){var o=this.getBiggerBinThan(t);return o?this.packToBin(o,e):this.items}for(var h=1;h<this.items.length;h++){var r=!1,s=this.items[h];if(t.weighItem(s))t:for(var u=0;u<3;u++)for(var a=0;a<t.items.length;a++){var c=void 0,f=t.items[a],l=f.getDimension();switch(u){case 0:c=[f.position[0]+l[0],f.position[1],f.position[2]];break;case 1:c=[f.position[0],f.position[1]+l[1],f.position[2]];break;case 2:c=[f.position[0],f.position[1],f.position[2]+l[2]]}if(t.putItem(s,c)){r=!0;break t}}if(!r){for(;null!==i;)if((i=this.getBiggerBinThan(t))&&(i.items.push(s),0===this.packToBin(i,i.items).length)){t=i,r=!0;break}r||n.push(s)}}return n}},{key:"pack",value:function(){for(this.bins.sort((function(t,e){return t.getVolume()-e.getVolume()})),this.items.sort((function(t,e){return e.getVolume()-t.getVolume()}));this.items.length>0;){var t=this.findFittedBin(this.items[0]);null!==t?this.items=this.packToBin(t,this.items):this.unfitItem()}return null}}]),i}()}(),n}()}));